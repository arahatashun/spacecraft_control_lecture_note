\documentclass[class=article, crop=false, dvipdfmx, fleqn]{standalone}
\input{../preamble}
\begin{document}
\section{姿勢運動にあたる外乱}
\subsection{Gravity Gradient Torque}
\qquad\qquad --- 地球中心と衛星各部の距離が異なることに起因\\
\begin{minipage}{0.45\linewidth}
\begin{tikzpicture}%ベクトル図
\coordinate (O) at (0, 0);

\begin{scope}[->]
\draw (O)--(-2, 2)node[above]{$dm$}--(-5, -4);
\draw (O)--(-5, -4)node[below left]{地球中心};
\end{scope}

\begin{scope}[-latex, thick, red]
\draw (O)--(1, 1)node[right]{$x$};
\draw (O)--(0.5, -1)node[right]{$y$};
\draw (O)--(-1.5, 0)node[left]{$z$};
\end{scope}

\begin{scope}[-latex, thick, darkgreen]
\draw (O)--(0.2, 1.5)node[right]{$x_0$（速度方向 at 円軌道）};
\draw (O)--(1, -1)node[right]{$y_0$};
\draw (O)--(-1, -0.8)node[below]{$z_0$（地心方向）};
\end{scope}

\draw (O) to[bend left=20] (2, 0)node[right]{衛星中心C};

\node at (-4, 0) {$\bm{R}$};
\node at (-2, -2) {$\bm{R_0}$};
\node at (-1, 1.3) {$\bm{r}$};
\end{tikzpicture}
\end{minipage}\hspace{15zw}
\begin{minipage}{0.4\linewidth}
\begin{tikzpicture}[scale = 0.8]	%孤
\coordinate (O) at (0, 0);

\begin{scope}[-latex]
\draw (O)--(1, 1)node[right]{$x_0$};
\draw (O)--(0, -1)node[below]{$y_0$（面外）};
\draw (O)--(-1, 1)node[right]{$z_0$};
\end{scope}

\draw [->] (O)--(-3, 3)node[above]{地球};
\draw [->] (-3, -1) arc [start angle = -90, end angle = -20, radius = 4.75];
\end{tikzpicture}
\end{minipage}

\noindent
\textcolor{darkgreen}{$x_0, y_0, z_0$ : orbital frame}\\
\textcolor{red}{$x, y, z$ : body frame}\\
$\bm{r}+\bm{R}=\bm{R_0}$\\
dmに働く力$d\bm{F}$は,
\begin{equation}
d\bm{F} = 
\frac{\mu_e \bm{R} dm}{\|\bm{R}\| ^3} =
\mu_e \frac{\bm{R_0} - \bm{r}}{\| \bm{R_0} - \bm{r} \| ^3} dm
\end{equation}
$\bm{r}\ll \bm{R_0}$より
\begin{equation}
d\bm{F} = \frac{\mu_e(\bm{R_0} -\bm{r})}{R_0^3}
\bigl[ 1 + 3\frac{\bm{r} \cdot \bm{R_0}}{R_0^2} + \underbrace{\mathrm{0}(\frac{r^2}{R_0^2})}_{0} \bigr]
\end{equation}
C周りのトルク
\begin{align}
\bm{g} &=
\int_m \bm{r} \times d\bm{F}\\ 
&=\frac{\mu_e}{R_0^3} 
\underbrace{\int \bm{r}\times
(\bm{R}_0 - \bm{r})dm}_{\bm{0}}
+\frac{3\mu_e}{R_0^5} \int \bm{r}\times (\bm{R}_0-\bm{r})
(\bm{r} \cdot \bm{R_0})dm\\
&(\because \bm{r}\times\bm{r}=\bm{0}
,\int \bm{r}dm=\bm{0})
\\
&= \frac{3\mu_e}{R_0^5} \int (\bm{r} \times \bm{R}_0) ( \bm{r} \cdot \bm{R_0} )dm
\end{align}\\
基準座標系として$x_0$，$y_0$，$z_0$は$z_0$が$\bm{R_0}$
方向を向くようにとる.\\
$x_0$，$y_0$，$z_0$から$xyz$（body frame）への変換を，
$z$軸周りに$\psi$，
$y$軸周りに$\theta$，
$x$軸周りに$\phi$の回転で表現する.
\begin{align}
\bm{R_0}^b=R_o
\begin{bmatrix}
-\sin\theta\\
\sin\phi\cos\theta\\
\cos\phi\cos\theta
\end{bmatrix},
\bm{r}^b=
\begin{bmatrix}
x\\
y\\
z
\end{bmatrix}
\end{align}
これ以降,b-frameで見た成分表記とする.
\begin{align}
\int(\bm{r}\times\bm{R}_0)
(\bm{r}\cdot\bm{R}_0)dm
&=R_0^2 \int
\begin{bmatrix}
y\cos\phi\cos\theta  -z\sin\phi\cos\theta\\
-z\sin\theta -x\cos\phi\cos\theta\\
x\sin\phi\cos\theta + y\sin\theta
\end{bmatrix}
(-x\sin\theta+
y\sin\phi\cos\theta+
z\cos\phi\cos\theta)dm\\
&=R_0^2\int
\begin{bmatrix}
(y^2-z^2)
\cos^2\theta\cos\phi\sin\phi
+f_1(xy,yz,zx)\\
(x^2-z^2)\sin\theta\cos\theta\cos\phi
+f_2(xy,yz,zx)\\
(y^2-x^2)\sin\theta\cos\theta\sin\phi+
f_3(xy,yz,zx)\\
\end{bmatrix}dm
\end{align}
\begin{align}
\left\{
\begin{array}{l}
y^2-z^2=(x^2+y^2)-(x^2+z^2)\\
f_1(xy,yz,zx)=f_2(xy,yz,zx)=f_3(xy,yz,zx)=0
(\because\text{慣性主軸})
\end{array}
\right.
\end{align}
\begin{align}
\rightarrow \bm{g}^b = \frac{3\mu_e}{R_0^3}
\begin{bmatrix}
(I_{xx}-I_{yy})\cos^2{\theta}
\cos{\phi} \sin{\phi} \\
(I_{zz}- I_{xx})\sin\theta\cos\theta\cos
\phi\\
(I_{xx}-I_{yy})\sin\theta\cos\theta\sin\phi
\end{bmatrix}
\end{align}
$\theta$と$\phi$が小さいケース
(=z軸がほぼ地心を向いている時)
\begin{align}
\frac{\mu_e}{R_0^3}&=\bm{0}
\end{align}
$\theta$と$\phi$が小さいケース
（$= z$軸がほぼ地心を向いているとき）
\begin{align}
\frac{\mu_\mathrm{e}}{{R_0}^3} & = {\omega_0}^2 \qquad (\omega_0 \text{: 軌道角速度}) \\
\bm{g}^\mathrm{b} & \fallingdotseq 3 {\omega_0}^2
\begin{bmatrix}
(I_{zz} - I_{yy}) \phi \\
(I_{zz} - I_{xx}) \theta \\
0
\end{bmatrix}
\end{align}
どういう形がよい？\\
%%%%%%%%%%%%%%
\begin{tikzpicture}%%角度足す
\coordinate (O) at (0, 0);
\coordinate (Y) at (2, -1);
\coordinate (Y0) at (2, 0);
\coordinate (Z) at (-1, -2);
\coordinate (Z0) at (0, -2.2);

\begin{scope}[-latex]
\draw (O)--(Y)node[right]{$y$};
\draw (O)--(Y0)node[right]{$y_0$};
\draw (O)--(Z)node[below]{$z$};
\draw (O)--(Z0)node[below]{$z_0$（地心）};
\end{scope}

\draw [->] (0, -0.5) node[below left = -0.8mm]{$\phi$} arc [start angle = 270, end angle = 243, radius = 0.5];
\draw [->] (0.5, 0) node[below right = -0.8mm]{$\phi$} arc [start angle = 0, end angle = -27, radius = 0.5];

\draw (O) circle [radius = 0.2];
\node [above left = 1] at (O) {$x_0$};
\end{tikzpicture}\\
%%%%%%%%%%%%%%%%%
\begin{minipage}{.4\textwidth}
\begin{tikzpicture}%%	円柱
\coordinate (O) at (0, 0);

\begin{scope}[-latex, thick]
\draw (O)--(2, -2)node[below right]{$x$};
\draw (O)--(2.4, 2)node[above right]{$y$};
\draw (O)--(0, 3)node[above]{$z$};
\end{scope}

\draw (-2, 1)--(-2, -1);
\draw (2, 1)--(2, -1);
\draw (0, 1) circle [x radius = 2, y radius = 0.6];
\draw (0, -1) circle [x radius = 2, y radius = 0.6];
\end{tikzpicture}
%%%%%%%%%%%%%
\end{minipage}
 \hfill
\begin{minipage}{.4\textwidth}
$I_{zz}-I_{yy}>0$\\
$\phi$が正の時トルクも正$\rightarrow$
ずれが拡大$\rightarrow$
不安定
\end{minipage}
%%%%%%%%%%%%%%%%
\begin{minipage}{.4\textwidth}
\begin{tikzpicture}%%円柱
\coordinate (O) at (0, 0);
\begin{scope}[->]
\draw(0, 0.5)--(0, 2);
\draw(0, -0.5)--(0, -2);
\end{scope}

\draw (1, 0.5)--(1, -0.5);
\draw (-1, 0.5)--(-1, -0.5);
\draw (0, 0.5) circle [x radius = 1, y radius = 0.4];
\draw (-1, -0.5) arc [start angle = 180, end angle = 360, x radius = 1, y radius = 0.4];
\draw [densely dashed] (-1, -0.5) arc [start angle = 180, end angle = 0, x radius = 1, y radius = 0.4];
\end{tikzpicture}
\end{minipage}
 \hfill
\begin{minipage}{.4\textwidth}
$I_{zz}-I_{yy}<0$\\
$\phi$が正の時トルクは負$\rightarrow$
ずれが小さくなる$\rightarrow$
安定
\end{minipage}\\
\begin{minipage}{0.4\linewidth}
\begin{tikzpicture}
\coordinate (O) at (0, 0);

\draw (0.8, 1)--(0.8, -1);
\draw (-0.8, 1)--(-0.8, -1);
\draw (0, 1) circle [x radius = 0.8, y radius = 0.3];
\draw (-0.8, -1) arc [start angle = 180, end angle = 360, x radius = 0.8, y radius = 0.3];

\begin{scope}[-latex]
\draw (O)--(1.5, -0.5)node[below]{$x$};
\draw (O)--(1.5, 1)node[right]{$y$};
\draw (O)--(0, -1.8)node[below left]{$z$}node[below right]{地心};
\end{scope}
\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.4\linewidth}
軌道上への「置き方」が重要\\
同様に$\theta$についての安定条件
\end{minipage}
$=I_{zz}-I_{xx}<0$\\
\qquad\qquad$\rightarrow$
「$I_{zz}$が最小」が安定のための必要条件\\
(補足)
\begin{enumerate}
\item gravity gradient torqueは外乱であると同時に,受動的な
姿勢制御に使える($\ang{1}\sim\ang{2}$)
\item 安定といっても$\theta,\phi \rightarrow 0$
に収束しない(0周りに振り子運動する=libration)
\end{enumerate}
$<$姿勢運動(地球指向のため)も考慮に入れたとき$>$\\
\qquad orbital frame 自体が動く(動座標系)\\
基準座標系としてorbital frameをとる($X,Y,Z$)$F_0$
($F_i\cdots$慣性系)\\
$\rightarrow$衛星とともにY軸周りに$\omega_0$で
回転\\
(X,Y,Z)$\rightarrow$xyz(b-frame)への変換を
$\underexpl{F_p}{\text{principle axis}},
(\phi,\theta,\psi)$の微小回転で表現する.\\
\begin{align}
\left\{
\begin{array}{ll}
\phi &= x\text{軸周りの回転}\\
\theta &= y\text{軸周りの回転}\\
\psi &=z\text{軸周りの回転}
\end{array}
\right.
\end{align}
やりたいこと
\begin{equation}
\text{Eulerの式}
\bm{M}^p=
I(\dot{\bm{\omega}}^p)+
\bm{\omega}^p\times
(I\bm{\omega}^p)
\qquad
\text{を書き下したい}
\end{equation}
$\bm{\omega}$ : $F_p$の$F_i$に対する角速度
\begin{equation}
\bm{\omega}
= \underexplline{\bm{\omega}_0}{i \rightarrow O} + \underexplline{\bm{\omega}_\alpha}{O \rightarrow p}\\
\end{equation}
\begin{align}
{\bm{\omega}_o}^{\overexpl[8pt]{i \ \text{or} \ O}{\text{最終的にpで表したいのでDCMが必要}}}
&=
\begin{bmatrix}
0 \\ 
-\omega_C
\\ 0
\end{bmatrix}
\left( \omega_C = \sqrt{\frac{\mu}{R^3}} \right) \\
 {\bm{\omega}_\alpha}^{p} &= 
\begin{bmatrix}
\dot{\phi} \\ \dot{\theta} \\ \dot{\psi}
\end{bmatrix}
\end{align}
$F_0$から$F_p$へのDCMは近似的に，
\begin{equation}
C_0^p = 
\begin{bmatrix}
1 & \psi & -\theta \\
-\psi & 1 & \phi \\
\theta & -\phi & 1
\end{bmatrix}
\qquad \qty(\theta, \ \phi, \ \psi \text{が十分小さい})
\end{equation}
\begin{align}
\rightarrow 
\bm{\omega}^p & =
C_0^p \bm{\omega}_o^o + 
\bm{\omega}_o^\alpha\\
& =
C_0^p 
\begin{bmatrix}
0 \\
-\omega_c \\
0 
\end{bmatrix} + 
\begin{bmatrix} 
\dot{\phi} \\
\dot{\theta} \\ 
\dot{\psi} \\
\end{bmatrix}\\
& = 
\begin{bmatrix}
\dot{\phi} - \omega_c \psi \\
\dot{\theta} - \omega_c \\
\dot{\psi} + \omega_c \phi
\end{bmatrix}\qquad
\left(=
\begin{bmatrix}
\omega_x\\
\omega_y\\
\omega_z
\end{bmatrix}
\right)
\end{align}
Eulerの式に代入すると
\begin{align}
\left\{
\begin{array}{ll}
I_{xx} \dot{\omega_x} 
+ (I_{zz} - I_{yy})\omega_y \omega_z 
&= 3 {\omega_c}^2 (I_{zz} - I_{yz})\phi \\
I_{yy} \dot{\omega_y} 
+ (I_{xx} - I_{zz})\omega_x \omega_z 
&= 3{\omega_c}^2 (I_{zz} - I_{xx}) \theta \\
I_{zz} \dot{\omega_z} 
+ (I_{yy} - I_{zz}) \omega_y \omega_z 
&= 0
\end{array}
\right.
\end{align}
簡略化のために
\begin{equation}
I_{xx}\equiv I_1,
I_{yy}\equiv I_2,
I_{zz}\equiv I_3\quad
\text{とする.}
\end{equation}
(Eulerの式の一つ目)
\begin{align}
&I_1\ddot{\phi}-
I_1\omega_c\dot{\psi}+
(I_3-I_2)(-\omega_c+\dot{\theta})
(\omega_c\phi+\dot{\psi})\\
&=I_1\ddot{\phi}-(I_1+I_3-I_2)
\omega_c\dot{\psi}+
(I_2-I_3)\omega_c-2\phi+
\mathcal{O}(\epsilon^2)\\
&=3\omega_c^2(I_3-I_2)\phi
\end{align}
このようにして外乱がgravity gradientのみの時に
\begin{align}
\begin{cases}
I_1\ddot{\theta}
-(I_1+I_3-I_2)\omega_c\dot{\phi}
+4(I_2-I_3)\omega_c
-2\phi
&=0 \qquad(1)\\
I_2\ddot{\theta}
+3(I_1-I_3)\omega_c^2\theta
&=0 \qquad(2)\\
I_3\ddot{\psi}
+(I_1+I_3-I_2)\omega_c\dot{\psi}
+(I_2-I_1)\omega_c^2\psi
&=0\qquad(3)
\end{cases}
\end{align}
定性的に
\begin{enumerate}
\item y軸まわりは独立している.
$I_1 > I_3$が安定のための必要十分条件
\item x,z軸は$\omega_c$を介してカップリングしている.
(1),(3)より\\
\begin{equation}
A \equiv
\begin{bmatrix}
I_1 & 0\\
0 & I_3 \\
\end{bmatrix}
\qquad
B \equiv
\begin{bmatrix}
0 & -1\\
1 & 0\\
\end{bmatrix}
(I_1 + I_3 - I_2) \omega_c
\qquad
C \equiv
\begin{bmatrix}
4(I_2- I_3) & 0\\
0 & I_2 - I_1\\
\end{bmatrix}
\omega_c
\end{equation}
\begin{equation}
\bm{q} \equiv
\begin{bmatrix}
\phi \\
\psi \\
\end{bmatrix}\qquad
\text{とすると}
\end{equation}
\begin{equation}
A \ddot{\bm{q}} + B \dot{\bm{q}} + C \bm{q} = \bm{0} 
\end{equation}
\end{enumerate}
上式の安定条件は?\\
\quad\underline{十分条件} Cがpositive definite(正定)であること
$(\forall \bm{x}, \bm{x}^T C \bm{x} > 0)$ \\
$\therefore I_2 - I_3 >0\wedge I_2 - I_1 > 0$\\
$\rightarrow$ 1,2から安定のための十分条件は
\begin{equation}
\overbrace{I_2}^{\text{ピッチ}} 
>
\overbrace{I_1}^{\text{ロール}} > 
\overbrace{I_3}^{\text{ヨー}}\qquad
(\omega_c \text{を考えなければ}I_2 > I_3 , I_1 > I_3)
\end{equation}
$<$補足$>$もし厳密な必要十分条件を出すなら
\begin{equation}
k_1=
\frac{I_2-I_3}{I_1},
k_3=
\frac{I_2-I_1}{I_3}
\qquad\text{で運動方程式を書き換えると}
\end{equation}
\begin{equation}
s^4+
(1+3k_1+k_1k_3)\omega_c^2s^2+
4k_1k_3\omega{c}^4=0\qquad
\text{(特性方程式)}
\end{equation}
4つの根が左半面にある条件

\begin{minipage}{0.45\linewidth}
\begin{tikzpicture}
\coordinate (O) at (0, 0);
\draw [-latex] (-2, 0)--(2, 0)node[right]{$k_1$};
\draw [-latex] (0, -2)--(0, 2)node[right]{$k_3$};
\draw (-1.6, -1.6) rectangle (1.6, 1.6);
\draw (2, 2)--(-0.3, -0.3)--(-0.3, -1.9)--(0, -1.6);
\fill [pattern = north west lines] (O)--(1.6, 1.6)--(1.6, 0)--cycle;
\fill [pattern = north west lines] (O)--(-0.3, -0.3)--(-0.3, -1.9)--(0, -1.6)--cycle;

\draw [darkgreen] (1, 0.5) to[bend left=20] (2.2, 1.2)node[right]{$I_2 > I_1 > I_3$に対応};
\draw [darkgreen] (-0.15, -1) to[bend left=20] (0.5, -2.4)node[right]{$I_2 > I_1 > I_3$にはない領域（エネルギー差につがあると不安定になる）};
\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.45\linewidth}
\begin{itemize}
\item $1+3k_1+k_1k_3>0$
\item $k_1k_3>0$
\item $
(1+3k_1+k_1k_3)^2-
16k_1k_3>0
$
\end{itemize}
\end{minipage}


\end{document}